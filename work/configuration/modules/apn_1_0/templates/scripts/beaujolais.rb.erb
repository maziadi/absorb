#!/usr/bin/ruby

require 'sinatra'

get '/access' do
  ref = params[:ref]
  mcc = params[:mcc]
#  date = params[:date]
#  case ref
#  when "0980000000001":
#    status 200
#    if mcc == "208"
#      "20000;500000\n"
#    else
#      "10000;250000\n"
#    end
#  when "R1235":
#    status 500
#  else
#    status 504
#    sleep 10
#  end
  status 200
  "10000000,,"
end

post '/report' do
  request.body.rewind
  p request.body.read
  p params
  ref = params[:ref]
  mcc = params[:mcc]
  used_tx = date = params[:tx]
  used_rx = date = params[:rx]
  date = params[:date]
#  case ref
#  when "0980000000001":
#    status 200
#  else
#    status 504
#  end
  status 200
end

