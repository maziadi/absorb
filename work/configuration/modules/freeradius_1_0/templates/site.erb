authorize {
  preprocess
  <% if log_details %>
  auth_log
  <% end %>
  <% if linelog %>
  linelog
  <% end %>
  <% if auth.include?("CHAP") %>
  chap
  <% end -%>
  <% if auth.include?("PEAP-MSCHAPV2") %>
  mschap
  <% end -%>
  #digest
  suffix
  <% if auth.include?("PEAP-MSCHAPV2") %>
  eap {
    ok = return
  }
  <% end %>
  <% if !db_auth %>
  files
  <% else %>
  sql
  <% end %>
  expiration
  logintime
  <% if auth.include?("PAP") %>
  pap
  <% end %>
}
authenticate {
  <% if auth.include?("PAP") %>
  Auth-Type PAP {
    pap
  }
  <% end %>
  <% if auth.include?("CHAP") %>
  Auth-Type CHAP {
    chap
  }
  <% end %>
  <% if auth.include?("PEAP-MSCHAPV2") %>
  Auth-Type MS-CHAP {
    mschap
  }
  <% end %>
  digest
  unix
  <% if auth.include?("PEAP-MSCHAPV2") %>
  eap
  <% end %>
  <% if linelog %>
  linelog
  <% end %>
}
preacct {
  preprocess
  acct_unique
  suffix
  files
}
accounting {
  <% if log_details %>
  detail
  <% end %>
  unix
  radutmp
  #exec
  <% if db_acct %>
  sql
  <% end %>
  <% if linelog %>
  linelog
  <% end %>
  attr_filter.accounting_response
}
session {
  radutmp
  <% if use_db %>
  sql
  <% end %>
}
post-auth {
  exec
  <% if db_auth %>
  sql
  <% end %>
  Post-Auth-Type REJECT {
    attr_filter.access_reject
    <% if use_db %>
    sql
    <% end %>
    <% if linelog %>
    linelog
    <% end %>
    <% if log_details %>
    reply_log
    <% end %>
  }
}
pre-proxy {
}
post-proxy {
  <% if auth.include?("PEAP-MSCHAPV2") %>
  eap
  <% end %>
}
