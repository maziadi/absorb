#!/bin/bash

pkg_version="<%= mobicents_version -%>"
pkg_name="mobicents-${pkg_version}" 
target_user=jboss-as
pkg="${pkg_name}.tar.gz"

error() {
  echo "ERROR: $1"
  exit -1
}

cd /tmp
wget -c http://gold.alphalink.fr/misc/${pkg} || error "Unable to download"
tar zxvf ${pkg} -C /opt/ || error "Unable to unpack"
chown -R ${target_user} /opt/mobicents
touch /etc/mobicents-installed-${pkg_version} || error "Unable to create flag file"
