# Path to load registry from csv
:registry_csv_path: '/data/apnf/registry'    # FULPFX
:operator_csv_path: '/data/apnf/operators'   # REFOPF
:prefixes_csv_path: '/data/apnf/prefixes'    # REFPFX

# File where BDC is dump
:registry_dump_file: '/data/apnf/registry_dump.csv'
:operator_dump_file: '/data/apnf/operators_dump.csv'
:prefixes_dump_file: '/data/apnf/prefixes_dump.csv'

# Default locale
:default_locale: fr

# APNF Ftp settings
:sic_ftp:
  :server: <%= apnf_ftp_host %>
  :user: <%= apnf_ftp_user %>
  :password: <%= apnf_ftp_passwd %>
  :port: <%= apnf_ftp_port %>

# Alphalink's operator code
:opta_code: &OPTACODE 'ALPL00'

# Operator FTP settings
:op_ftp:
  :server: <%= operator_ftp_host %>
  :user: <%= operator_ftp_user %>
  :password: <%= operator_ftp_passwd %>

# Init sys FTP settings
:ftp_process_dir:
  :advert: ANN/IN
  :bdc_update: BDC
  :advert_report: BDC

# Prefix for files naming
:file_prefix:
  :advert: *OPTACODE

#temporary files storage
:tmp_dir: tmp

# Init sys ftp poll frequency ex : 2s ... 4m ... 1d ...
:ftp_poll_rate: 600s

# The retry delay for an unacknowledged advert
:advert_retry_delay: 150s

# Self explanatory
:log_file: log/app.log

# The subcribed advert processes [Array]:
# PTG : portage
# RES : restitutions
# PFX : prefixage
:allowed_advert_processes:
  - PTG

# The publication flow we subccribed [Array]
#  - DL4PFX : Delta 4 heures prefixage
#  - DLQFAC : Delta quotidien facturation
#  - DLQPFX : Delta quotidien prefixage
:subscribed_publications_flows:
  - DL4PFX
  - DLQFAC
  - DLQPFX

# The allowed transitions for APNF advert's steps
# leave the single dashes for a nil value eg : Pre is the first step it could be nil before.
:allowed_transitions:
  PRE:
    :from:
      - ANN
      - REA
      - 
    :to:
      - MOD
      - ANN
      - REA
  MOD:
    :from:
      - PRE
      - MOD
    :to:
      - ANN
      - MOD
      - REA
  ANN:
    :from:
      - MOD
      - PRE
    :to:
      - PRE
  ~:
    :from:
      -
    :to:
      - PRE
      - REA
  REA:
    :from:
      - MOD
      - PRE
      -
    :to:
      - PRE



:mandatory_fields:
  RES:
    REA:
      - :effective_date
      - :effective_hour
      - :ope
      - :opet
  PTG:
    ANN:
    - :opr
    - :oprt
    - :prefix
    MOD:
    - :opr
    - :oprt
    - :prefix
    REA:
    - :opr
    - :oprt
    - :prefix
    - :effective_date
    - :effective_hour
    PRE:
    - :opr
    - :oprt
    - :prefix
