defaults: &defaults

  # Single Host setup :
  # host: localhost
  # slaves:
  #  - host: slave1.local
  #    port: 27018
  #  - host: slave2.local
  #    port: 27019

  # Replica Sets setups :
  host: localhost
  # hosts: [['10.0.144.172', 27017],['10.0.144.157', 27018]]
  # Do not set to true for now ( Not yet ready for active/active taxman config )
  read_secondary: false

  # Kept to true in order to keep malformed cdr_logs
  allow_dynamic_fields: true

  # We dont need SEO substrings
  parameterize_keys: false

  # Investigate on the performance cost when set to true
  persist_in_safe_mode: false

  # Returns nil instead of Mongoid::Error::DocumentNotFound when documents are not found by _id
  raise_not_found_error: false

  # It will try 3 times to reconnect if connection get lost
  reconnect_time: 3

  # Only for model inheritance concern
  # this may be remove in further releases of mongodb
  persist_types: false
  option_no_exist: false
  skip_version_check: false

  # We dont want to create_indexes each time the class model is read
  autocreate_indexes: false
  include_root_in_json: false

<%= environment %>:
  <<: *defaults
  sessions:
    default:
      database: taxman_<%= environment %>
      hosts:
<% taxerp_mongo_hosts.each do |host| -%>
        - <%= host -%>:27017
<% end -%>
      options:
        consistency: :strong
