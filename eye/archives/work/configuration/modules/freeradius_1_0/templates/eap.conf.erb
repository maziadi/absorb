  eap {
    <%  
      if auth.include?('pap')
         default_eap_type = 'gtc'
      elsif auth.include?('peap-mschapv2')
         default_eap_type = 'peap'
      end
    -%>
    default_eap_type = <%= default_eap_type %>
    timer_expire     = 60
    ignore_unknown_eap_types = no
    cisco_accounting_username_bug = no
    max_sessions = 4096
    md5 {
    }
    leap {
    }
    gtc {
      auth_type = PAP
    }
    tls {
      certdir = ${confdir}/certs
      cadir = ${confdir}/certs
      private_key_password = alphalinkinitsys
      private_key_file = ${certdir}/server.key
      #certificate_file = ${certdir}/server.pem
      certificate_file = ${certdir}/server.crt
      #CA_file = ${cadir}/cacert.crt
      CA_file = ${cadir}/ca.crt
      dh_file = ${certdir}/dh
      random_file = /dev/urandom
      CA_path = ${cadir}
      cipher_list = "DEFAULT"
      make_cert_command = "${certdir}/bootstrap"
      cache {
            enable = no
            max_entries = 255
      }
      verify {
      }
    }
    ttls {
      default_eap_type = md5
      copy_request_to_tunnel = no
      use_tunneled_reply = no
      virtual_server = "inner-tunnel"
    }
    peap {
      default_eap_type = mschapv2
      copy_request_to_tunnel = no
      use_tunneled_reply = no
    }
    mschapv2 {
    }
  }

