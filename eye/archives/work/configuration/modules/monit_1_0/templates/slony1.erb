<% slony1_databases.each do |database| -%>
check process slony1_<%= database %>
  with pidfile "/var/run/slony1/<%= database %>.pid"
  start program = "/etc/init.d/slony1 start"
  stop program = "/etc/init.d/slony1 stop"
  alert <%= monit_conf_alert_email %>
  if 3 restarts within 4 cycles then timeout
  if totalmem > 150 Mb then alert
  if children > 255 for 5 cycles then restart
  if children > 100 for 5 cycles then alert
  if cpu usage > 95% for 3 cycles then restart
  if cpu usage > 60% for 3 cycles then alert

<% end -%>
